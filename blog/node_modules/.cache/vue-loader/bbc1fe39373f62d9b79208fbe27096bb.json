{"remainingRequest":"/usr/local/var/www/blog/blog/node_modules/vue-loader/lib/index.js??vue-loader-options!/usr/local/var/www/blog/blog/src/components/loginOrRegister/register.vue?vue&type=script&lang=js&","dependencies":[{"path":"/usr/local/var/www/blog/blog/src/components/loginOrRegister/register.vue","mtime":1543398920895},{"path":"/usr/local/var/www/blog/blog/node_modules/cache-loader/dist/cjs.js","mtime":499162500000},{"path":"/usr/local/var/www/blog/blog/node_modules/babel-loader/lib/index.js","mtime":499162500000},{"path":"/usr/local/var/www/blog/blog/node_modules/cache-loader/dist/cjs.js","mtime":499162500000},{"path":"/usr/local/var/www/blog/blog/node_modules/vue-loader/lib/index.js","mtime":499162500000}],"contextDependencies":[],"result":["//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n\n\timport { mapMutations, mapActions } from 'vuex'\n\n\texport default {\n\t\tdata(){\n\t\t\treturn {\n\t\t\t\tshow:false,\n\t\t\t\t//表单数据\n\t\t\t\truleForm:{\n\t\t\t\t\taccount:'',\n\t\t\t\t\tpassword:'',\n\t\t\t\t\tname:'',\n\t\t\t\t\tyzm:'',\n\t\t\t\t\tsms:'',\n\t\t\t\t},\n\t\t\t\t//验证码图片\n\t\t\t\tcaptchas:'',\n\t\t\t\t//验证码的key\n\t\t\t\tcaptcha_key:'',\n\t\t\t\t//是否显示验证码输入框\n\t\t\t\tshowcaptchas:false,\n\t\t\t\t//是否显示短信验证\n\t\t\t\tshowSms:false,\n\t\t\t\t//短信验证码的key\n\t\t\t\tsmskey:'',\n\n\t\t\t\t//控制下一步按钮是否可以点击\n\t\t\t\tisdis:false,\n\t\t\t\tissendSms:false,\n\n\t\t\t\t//自定义错误消息\n\t\t\t\terrorMsg:'',\n\t\t\t\terrorphone:'',\n\t\t\t\terrorSms:'',\n\t\t\t\terrorName:'',\n\n\t\t\t\t//验证码刷新等待\n\t\t\t\tisreloadYzm:true,\n\n\t\t\t\t//注册按钮的显示\n\t\t\t\tisZc:true,\n\n\t\t\t\trules:{\n\t\t\t\t\taccount: [\n\t\t\t            { required: true, message: '请输入账号', trigger: 'blur' },\n\t\t\t            { min: 3, max: 20, message: '长度在 3 到 20 个字符', trigger: 'blur' },\n\t\t\t            { pattern: /^1[34578]\\d{9}$/, message: '手机号格式不正确',trigger: 'blur'}\n          \t\t\t],\n          \t\t\tyzm: [\n          \t\t\t\t{required:true, message:'请输入验证码',trigger: 'blur'}\n          \t\t\t],\n          \t\t\tsms: [\n          \t\t\t\t{required:true, message:'请输入短信验证码',trigger:'blur'}\n          \t\t\t],\n          \t\t\tname: [\n          \t\t\t\t{required: true,message:'请输入昵称' , trigger:'blur'},\n          \t\t\t\t{min:2,max:10, message:'长度在 2 到 10 个字符' ,  trigger:'blur'}\n          \t\t\t],\n          \t\t\tpassword:[\n          \t\t\t\t{required: true,message:'请输入密码', trigger:'blur' },\n          \t\t\t\t// {pattern:/^(?![0-9]+$)(?![a-zA-Z]+$)[0-9A-Za-z]{8,16}$/, message:\"请输入密码，不可以全是字母或数字,且长度在8位以上\",trigger:'blur'},\n          \t\t\t\t{min:6, max:20, message:'长度在 6 到 20 个字符',trigger:'blur'}\n          \t\t\t],\n          \t\t\t\n\t\t\t\t}\n\t\t\t}\n\t\t},\n\t    mounted:function(){\n\n\t      setTimeout(function(){ this.show = true} ,200);\n\t    },\n\t\tcomputed:{\n\t\t\t...mapActions([\n                'setUser',\n\t\t\t]),\n\t\t},\n\t    methods:{\n\t\t\t...mapMutations({\n                setverbState: 'SET_VERBSTATE',\n                setToken: 'SET_TOKEN',\n\t\t\t}),\n\n\t\t    register() {\n\t\t    \tthis.$emit('log',true);\n\t\t    },\n\t\t    getCap(formName, field) {\n\n\t\t    \t//验证手机号是否正确进行下一步\n\t\t\t\tthis.errorphone = '';\n\n\t\t    \t//使用了element ui 的form组件 个别字段验证  验证手机号\n\t    \t  \tthis.$refs[formName].validateField(field,(valid) => {\n\n\t\t    \t\tif(valid === ''){\n\n                        //验证手机获取图片验证码\n\t\t\t\t\t\tlet paramObj = {\n\t\t\t\t\t\t  phone:this.ruleForm.account,\n\t\t\t\t\t\t};\n\n                        this.$server.getCaptchas(paramObj).then(data => {\n\n                            //把获取到的图片和key 传递给下一个步骤\n                            this.captchas = data.captcha_image_content;\n                            this.captcha_key = data.captcha_key;\n                            this.showcaptchas = true;\n                            this.isdis = true;\n                            this.isreloadYzm = true;\n\n\t\t\t\t\t\t}).catch(err => {\n\n                            if(err.status === 422) {\n                                this.errorphone = '电话号已存在';\n                                return false;\n                            }\n\n                            if(err.status === 429) {\n                                this.errorphone = '操作次数错过，请稍后再试';\n                                this.showcaptchas = false;\n                                return false;\n                            }\n\t\t\t\t\t\t})\n\n\n\t\t    \t\t}\n\n\t\t    \t})\n\t\t    },\n\t\t    //监听用户是否改变手机号 重新获取验证码\n\t\t    oninput() {\n\t\t    \tthis.isdis = false;\n\t\t    \tthis.showcaptchas = false;\n\t\t    \tthis.ruleForm.yzm = '';\n\t\t    },\n\t\t    reloadYzm() {\n\t\t    \tthis.isreloadYzm =false;\n\t\t    \tsetTimeout(()=>{ this.getCap('ruleForm','account'); },500)\n\t\t    },\n\t\t    checkYzm(formName, field, event) {\n\n\n\t\t    \t//请空自定义消息\n\t\t    \tthis.errorMsg = '';\n\t\t    \t//使用了element ui 的form组件 个别字段验证 验证 验证码\n\t    \t  \tthis.$refs[formName].validateField(field,(valid) => {\n\n\t    \t  \t\tif(valid === ''){\n\n\t    \t  \t\t    let paramObj = {\n\n                            captcha_key:this.captcha_key,\n                            captcha_code:this.ruleForm.yzm,\n\n\t\t\t\t\t\t};\n\n\t    \t  \t\t    this.$server.checkYzm(paramObj).then(data => {\n                            let num = 60;\n\n                            const time = setInterval(() => {\n\n                                event.target.innerHTML=num;\n\n                                num--;\n\n                                if(num === 0) {\n\n                                    clearInterval(time);\n                                    this.issendSms = false;\n                                    event.target.innerHTML='发送短信';\n\n                                }\n\n                            } ,1000);\n\n                            this.issendSms = true;\n\n                            //存入验证短信验证码的key\n                            this.smskey = data.key;\n\n                            //显示密码 昵称等输入框\n                            this.showSms = true;\n\n                        }).catch(err => {\n                            if (err.status === 401) {\n\n                                this.getCap('ruleForm', 'yzm');\n                                this.errorMsg = err.message;\n                                return false;\n\n                            }else if(err.status === 429) {\n\n                                this.errorMsg = '操作次数过多，请稍后再试';\n                                //让输入验证码input 消失\n                                this.isdis = false;\n                                this.showcaptchas = false;\n                                this.ruleForm.yzm = '';\n                                return false;\n\n                            }else if(err.status === 422) {\n\n                                this.errorMsg = '图片验证码已失效,点就图片重新获取';\n                                return false;\n\n                            }\n\t\t\t\t\t\t});\n\n\t    \t  \t\t}\n\n\t    \t  \t})\n\t\t    },\n\t\t    //提交注册\n\t\t    regNow(formName, field1, field2, field3) {\n\t\t    \t// console.log(1);\n\t\t    \t//name\n\t\t    \tlet name = '';\n\t\t    \t//pass\n\t\t    \tlet pass = '';\n\t\t    \t//sms\n\t\t    \tlet sms = '';\n\n\t\t    \t//按钮控制\n\t\t    \tthis.isZc = false;\n\t\t    \t//昵称验证\n\t\t    \tthis.$refs[formName].validateField(field1,(valid) => {\n\t\t    \t\tname = valid;\n\t\t    \t});\n\t\t    \t//密码验证\n\t\t    \tthis.$refs[formName].validateField(field2,(valid) => {\n\t\t    \t\tpass = valid;\n\t\t    \t});\n\n\t\t    \t//短信验证码验证\n\t\t    \tif(pass === '' && name === ''){\n\n\t\t    \t\tthis.$refs[formName].validateField(field3,(valid) => {\n\n\t\t\t\t\t\tif(valid === ''){\n\n\t\t\t\t\t\t\t//判断短信验证码是否完成注册\n\t\t\t\t\t\t\tlet paramObj = {\n                                verification_key:this.smskey,\n                                password:this.ruleForm.password,\n                                name:this.ruleForm.name,\n                                phone:this.ruleForm.account,\n                                verification_code:this.ruleForm.sms,\n\n                            };\n\n\t\t\t\t\t\t\tthis.$server.regNow(paramObj).then(data => {\n\n                                const token = data.meta.access_token;\n\n                                //把注册后的token 存储在vuex 中 还有登录状态\n                                this.setverbState(true);\n                                this.setToken(token);\n                                //获取user基本信息\n                                this.setUser;\n\n                                //使用localStorage 存储登录信息\n                                localStorage.setItem('access_token',token);\n\n                                localStorage.setItem('verbState','true');\n\n                                //登录成功后的提示信息\n                                this.$message({\n                                    message: '注册成功，开始您的流域',\n                                    type: 'success'\n                                });\n\n                                //判断按钮状态\n                                this.isZc = true;\n\n                                //跳转到主页\n                                this.$router.push({name:'index'})\n\n\t\t\t\t\t\t\t}).catch(err => {\n\n                                if (err.status === 422) {\n\n                                    this.errorName = '昵称已存在';\n                                    return false;\n\n                                }else if(err.status === 401){\n\n                                    this.errorSms = '验证码错误';\n                                    return false;\n\n                                }else if(err.status === 423){\n\n                                    this.errorSms = '验证码失效，请重新发送';\n                                    this.getCap('ruleForm','account');\n                                    return false;\n\n                                }\n\n                            });\n\n\t\t\t    \t\t}\n\n\t\t    \t\t});\n\t\t    \t}\n\n\n\t\t    }\n\n\t    }\n\n\t}\n",{"version":3,"sources":["register.vue"],"names":[],"mappings":";;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;AAyGA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;;AAEA;AACA;;AAEA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;;AAEA;AACA;;AAEA;;AAEA;AACA;AACA;AACA;;AAEA;;AAEA;AACA;AACA;AACA;AACA;AACA;;AAEA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;;;AAGA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;;AAGA;AACA;AACA;AACA;;AAEA;;AAEA;;AAEA;AACA;;AAEA;;AAEA;AACA;;AAEA;;AAEA;;AAEA;;AAEA;;AAEA;AACA;AACA;;AAEA;;AAEA;;AAEA;;AAEA;AACA;;AAEA;AACA;;AAEA;AACA;;AAEA;AACA;AACA;;AAEA;;AAEA;AACA;AACA;AACA;AACA;AACA;;AAEA;;AAEA;AACA;;AAEA;AACA;;AAEA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;;AAEA;;AAEA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;;AAEA;;AAEA;;AAEA;AACA;AACA;AACA;AACA;;AAEA;AACA;;AAEA;;AAEA;AACA;AACA;AACA;AACA;;AAEA;AACA;;AAEA;AACA;;AAEA;;AAEA;;AAEA;AACA;;AAEA;;AAEA;AACA;;AAEA;;AAEA;AACA;AACA;;AAEA;;AAEA;;AAEA;;AAEA;AACA;;;AAGA;;AAEA;;AAEA","file":"register.vue","sourceRoot":"src/components/loginOrRegister","sourcesContent":["<style type=\"scoped\" lang=\"scss\">\n@import '@/assets/css/register.scss';\n</style>\n\n<template>\n\t<div>\n\t\t<div id=\"register\">\n\t\t\t<div id=\"register-title\">\n\t\t\t\t加入流域\n\t\t\t</div>\n\n\t\t\t<el-form :model=\"ruleForm\" :rules=\"rules\" ref=\"ruleForm\" class=\"demo-ruleForm\">\n\t\t\t\t<div class=\"register-user\">\n\t\t\t\t\t<el-form-item prop=\"account\" :error=\"errorphone\">\n\t\t\t\t\t\t<el-input\n\t\t\t\t\t\t    placeholder=\"输入手机号\"\n\t\t\t\t\t\t    suffix-icon=\"el-icon-phone\"\n\t\t\t\t\t\t    v-model=\"ruleForm.account\"\n\t\t\t\t\t\t    id=\"register-user-input0\"\n\t\t\t\t\t\t    @input=\"oninput()\"\n\t\t\t\t\t\t    >\n\t\t\t\t\t\t    <el-button :disabled='isdis' @click=\"getCap('ruleForm', 'account')\" slot=\"append\">下一步</el-button>\n\t\t\t\t\t\t</el-input>\n\t\t\t\t\t</el-form-item>\n\t\t\t\t</div>\n\t\t\t\t<transition-group name=\"slide-fade\">\n\t\t\t\t<div :key=\"1\" class=\"register-user\" v-if=\"showcaptchas\" >\n\t\t\t\t\t<el-form-item prop=\"yzm\" :error=\"errorMsg\" >\n\t\t\t\t\t\t<el-input\n\t\t\t\t\t\t    placeholder=\"输入验证码\"\n\t\t\t\t\t\t    suffix-icon=\"el-icon-document\"\n\t\t\t\t\t\t    v-model=\"ruleForm.yzm\"\n\t\t\t\t\t\t    id=\"register-user-input\"\n\n\t\t\t\t\t\t    >\n\n\t\t\t\t\t\t    <el-button  slot=\"prepend\" style=\"padding:0px;\">\n\t\t\t\t\t\t    \t<img v-if=\"isreloadYzm\" @click=\"reloadYzm()\" width=\"120px\" style=\"margin-top:11px;\" :src=\"captchas\">\n\t\t\t\t\t\t    \t<i v-else class=\"el-icon-loading\"></i>\n\t\t\t\t\t\t    </el-button>\n\n\n\t\t\t\t\t\t\t<el-button :disabled='issendSms'  slot=\"append\" @click=\"checkYzm('ruleForm', 'yzm', $event)\" style=\"width:84px;padding:0px;\">发送短信</el-button>\n\t\t\t\t\t\t</el-input>\n\t\t\t\t\t</el-form-item>\n\t\t\t\t</div>\n\n\t\t\t\t<div :key=\"2\" class=\"register-user\" v-if=\"showSms\" >\n\t\t\t\t\t<el-form-item :error=\"errorName\" prop=\"name\">\n\t\t\t\t\t\t<el-input\n\t\t\t\t\t\t    placeholder=\"输入昵称\"\n\t\t\t\t\t\t    suffix-icon=\"el-icon-tickets\"\n\t\t\t\t\t\t    v-model=\"ruleForm.name\"\n\t\t\t\t\t\t    id=\"register-user-input3\"\n\t\t\t\t\t\t    >\n\n\t\t\t\t\t\t\t\n\t\t\t\t\t\t</el-input>\n\t\t\t\t\t</el-form-item>\n\n\t\t\t\t\t<el-form-item prop=\"password\">\n\t\t\t\t\t\t<el-input\n\t\t\t\t\t\t    placeholder=\"请输入密码\"\n\t\t\t\t\t\t    suffix-icon=\"el-icon-edit-outline\"\n\t\t\t\t\t\t    v-model=\"ruleForm.password\"\n\t\t\t\t\t\t    id=\"register-user-input4\"\n\t\t\t\t\t\t    type=\"password\"\n\t\t\t\t\t\t    >\n\n\t\t\t\t\t\t</el-input>\n\t\t\t\t\t</el-form-item>\n\n\t\t\t\t\t<el-form-item prop=\"sms\" :error=\"errorSms\">\n\t\t\t\t\t\t<el-input\n\t\t\t\t\t\t    placeholder=\"输入短信验证码\"\n\t\t\t\t\t\t    suffix-icon=\"el-icon-message\"\n\t\t\t\t\t\t    v-model=\"ruleForm.sms\"\n\t\t\t\t\t\t    id=\"register-user-input5\"\n\t\t\t\t\t\t    >\n\n\t\t\t\t\t\t\t<el-button slot=\"append\" @click=\"regNow('ruleForm','name', 'password', 'sms')\">\n\t\t\t\t\t\t\t\t<span v-if=\"isZc\">注册</span>\n\t\t\t\t\t\t\t\t<i v-else class=\"el-icon-loading\"></i>\n\t\t\t\t\t\t\t</el-button>\n\n\t\t\t\t\t\t</el-input>\n\t\t\t\t\t</el-form-item>\n\n\t\t\t\t</div>\n\n\t\t\t\t</transition-group>\n\t\t\t</el-form>\n\n\t\t\t<div id=\"register-ds\">\n\t\t\t\t<span style=\"float:left\">第三方登录:</span>\n\t\t\t\t<img class=\"register-icon\" src=\"@/assets/qqicon.png\" /> \n\t\t\t\t<img class=\"register-icon\" src=\"@/assets/weibo.png\" />\n\n\t\t\t\t<div class=\"register\"  @click=\"register()\" style=\"margin-left:200px;\">已有账号？立即账号</div>\n\t\t\t</div>\n\t\t</div>\n\t</div>\n</template>\nselect sum(pay),(select u.pay where finance_month='2018-09')  from userinfos as u where uid=1062853110 and finance_month='2018-10';\n<script>\n\timport { mapMutations, mapActions } from 'vuex'\n\n\texport default {\n\t\tdata(){\n\t\t\treturn {\n\t\t\t\tshow:false,\n\t\t\t\t//表单数据\n\t\t\t\truleForm:{\n\t\t\t\t\taccount:'',\n\t\t\t\t\tpassword:'',\n\t\t\t\t\tname:'',\n\t\t\t\t\tyzm:'',\n\t\t\t\t\tsms:'',\n\t\t\t\t},\n\t\t\t\t//验证码图片\n\t\t\t\tcaptchas:'',\n\t\t\t\t//验证码的key\n\t\t\t\tcaptcha_key:'',\n\t\t\t\t//是否显示验证码输入框\n\t\t\t\tshowcaptchas:false,\n\t\t\t\t//是否显示短信验证\n\t\t\t\tshowSms:false,\n\t\t\t\t//短信验证码的key\n\t\t\t\tsmskey:'',\n\n\t\t\t\t//控制下一步按钮是否可以点击\n\t\t\t\tisdis:false,\n\t\t\t\tissendSms:false,\n\n\t\t\t\t//自定义错误消息\n\t\t\t\terrorMsg:'',\n\t\t\t\terrorphone:'',\n\t\t\t\terrorSms:'',\n\t\t\t\terrorName:'',\n\n\t\t\t\t//验证码刷新等待\n\t\t\t\tisreloadYzm:true,\n\n\t\t\t\t//注册按钮的显示\n\t\t\t\tisZc:true,\n\n\t\t\t\trules:{\n\t\t\t\t\taccount: [\n\t\t\t            { required: true, message: '请输入账号', trigger: 'blur' },\n\t\t\t            { min: 3, max: 20, message: '长度在 3 到 20 个字符', trigger: 'blur' },\n\t\t\t            { pattern: /^1[34578]\\d{9}$/, message: '手机号格式不正确',trigger: 'blur'}\n          \t\t\t],\n          \t\t\tyzm: [\n          \t\t\t\t{required:true, message:'请输入验证码',trigger: 'blur'}\n          \t\t\t],\n          \t\t\tsms: [\n          \t\t\t\t{required:true, message:'请输入短信验证码',trigger:'blur'}\n          \t\t\t],\n          \t\t\tname: [\n          \t\t\t\t{required: true,message:'请输入昵称' , trigger:'blur'},\n          \t\t\t\t{min:2,max:10, message:'长度在 2 到 10 个字符' ,  trigger:'blur'}\n          \t\t\t],\n          \t\t\tpassword:[\n          \t\t\t\t{required: true,message:'请输入密码', trigger:'blur' },\n          \t\t\t\t// {pattern:/^(?![0-9]+$)(?![a-zA-Z]+$)[0-9A-Za-z]{8,16}$/, message:\"请输入密码，不可以全是字母或数字,且长度在8位以上\",trigger:'blur'},\n          \t\t\t\t{min:6, max:20, message:'长度在 6 到 20 个字符',trigger:'blur'}\n          \t\t\t],\n          \t\t\t\n\t\t\t\t}\n\t\t\t}\n\t\t},\n\t    mounted:function(){\n\n\t      setTimeout(function(){ this.show = true} ,200);\n\t    },\n\t\tcomputed:{\n\t\t\t...mapActions([\n                'setUser',\n\t\t\t]),\n\t\t},\n\t    methods:{\n\t\t\t...mapMutations({\n                setverbState: 'SET_VERBSTATE',\n                setToken: 'SET_TOKEN',\n\t\t\t}),\n\n\t\t    register() {\n\t\t    \tthis.$emit('log',true);\n\t\t    },\n\t\t    getCap(formName, field) {\n\n\t\t    \t//验证手机号是否正确进行下一步\n\t\t\t\tthis.errorphone = '';\n\n\t\t    \t//使用了element ui 的form组件 个别字段验证  验证手机号\n\t    \t  \tthis.$refs[formName].validateField(field,(valid) => {\n\n\t\t    \t\tif(valid === ''){\n\n                        //验证手机获取图片验证码\n\t\t\t\t\t\tlet paramObj = {\n\t\t\t\t\t\t  phone:this.ruleForm.account,\n\t\t\t\t\t\t};\n\n                        this.$server.getCaptchas(paramObj).then(data => {\n\n                            //把获取到的图片和key 传递给下一个步骤\n                            this.captchas = data.captcha_image_content;\n                            this.captcha_key = data.captcha_key;\n                            this.showcaptchas = true;\n                            this.isdis = true;\n                            this.isreloadYzm = true;\n\n\t\t\t\t\t\t}).catch(err => {\n\n                            if(err.status === 422) {\n                                this.errorphone = '电话号已存在';\n                                return false;\n                            }\n\n                            if(err.status === 429) {\n                                this.errorphone = '操作次数错过，请稍后再试';\n                                this.showcaptchas = false;\n                                return false;\n                            }\n\t\t\t\t\t\t})\n\n\n\t\t    \t\t}\n\n\t\t    \t})\n\t\t    },\n\t\t    //监听用户是否改变手机号 重新获取验证码\n\t\t    oninput() {\n\t\t    \tthis.isdis = false;\n\t\t    \tthis.showcaptchas = false;\n\t\t    \tthis.ruleForm.yzm = '';\n\t\t    },\n\t\t    reloadYzm() {\n\t\t    \tthis.isreloadYzm =false;\n\t\t    \tsetTimeout(()=>{ this.getCap('ruleForm','account'); },500)\n\t\t    },\n\t\t    checkYzm(formName, field, event) {\n\n\n\t\t    \t//请空自定义消息\n\t\t    \tthis.errorMsg = '';\n\t\t    \t//使用了element ui 的form组件 个别字段验证 验证 验证码\n\t    \t  \tthis.$refs[formName].validateField(field,(valid) => {\n\n\t    \t  \t\tif(valid === ''){\n\n\t    \t  \t\t    let paramObj = {\n\n                            captcha_key:this.captcha_key,\n                            captcha_code:this.ruleForm.yzm,\n\n\t\t\t\t\t\t};\n\n\t    \t  \t\t    this.$server.checkYzm(paramObj).then(data => {\n                            let num = 60;\n\n                            const time = setInterval(() => {\n\n                                event.target.innerHTML=num;\n\n                                num--;\n\n                                if(num === 0) {\n\n                                    clearInterval(time);\n                                    this.issendSms = false;\n                                    event.target.innerHTML='发送短信';\n\n                                }\n\n                            } ,1000);\n\n                            this.issendSms = true;\n\n                            //存入验证短信验证码的key\n                            this.smskey = data.key;\n\n                            //显示密码 昵称等输入框\n                            this.showSms = true;\n\n                        }).catch(err => {\n                            if (err.status === 401) {\n\n                                this.getCap('ruleForm', 'yzm');\n                                this.errorMsg = err.message;\n                                return false;\n\n                            }else if(err.status === 429) {\n\n                                this.errorMsg = '操作次数过多，请稍后再试';\n                                //让输入验证码input 消失\n                                this.isdis = false;\n                                this.showcaptchas = false;\n                                this.ruleForm.yzm = '';\n                                return false;\n\n                            }else if(err.status === 422) {\n\n                                this.errorMsg = '图片验证码已失效,点就图片重新获取';\n                                return false;\n\n                            }\n\t\t\t\t\t\t});\n\n\t    \t  \t\t}\n\n\t    \t  \t})\n\t\t    },\n\t\t    //提交注册\n\t\t    regNow(formName, field1, field2, field3) {\n\t\t    \t// console.log(1);\n\t\t    \t//name\n\t\t    \tlet name = '';\n\t\t    \t//pass\n\t\t    \tlet pass = '';\n\t\t    \t//sms\n\t\t    \tlet sms = '';\n\n\t\t    \t//按钮控制\n\t\t    \tthis.isZc = false;\n\t\t    \t//昵称验证\n\t\t    \tthis.$refs[formName].validateField(field1,(valid) => {\n\t\t    \t\tname = valid;\n\t\t    \t});\n\t\t    \t//密码验证\n\t\t    \tthis.$refs[formName].validateField(field2,(valid) => {\n\t\t    \t\tpass = valid;\n\t\t    \t});\n\n\t\t    \t//短信验证码验证\n\t\t    \tif(pass === '' && name === ''){\n\n\t\t    \t\tthis.$refs[formName].validateField(field3,(valid) => {\n\n\t\t\t\t\t\tif(valid === ''){\n\n\t\t\t\t\t\t\t//判断短信验证码是否完成注册\n\t\t\t\t\t\t\tlet paramObj = {\n                                verification_key:this.smskey,\n                                password:this.ruleForm.password,\n                                name:this.ruleForm.name,\n                                phone:this.ruleForm.account,\n                                verification_code:this.ruleForm.sms,\n\n                            };\n\n\t\t\t\t\t\t\tthis.$server.regNow(paramObj).then(data => {\n\n                                const token = data.meta.access_token;\n\n                                //把注册后的token 存储在vuex 中 还有登录状态\n                                this.setverbState(true);\n                                this.setToken(token);\n                                //获取user基本信息\n                                this.setUser;\n\n                                //使用localStorage 存储登录信息\n                                localStorage.setItem('access_token',token);\n\n                                localStorage.setItem('verbState','true');\n\n                                //登录成功后的提示信息\n                                this.$message({\n                                    message: '注册成功，开始您的流域',\n                                    type: 'success'\n                                });\n\n                                //判断按钮状态\n                                this.isZc = true;\n\n                                //跳转到主页\n                                this.$router.push({name:'index'})\n\n\t\t\t\t\t\t\t}).catch(err => {\n\n                                if (err.status === 422) {\n\n                                    this.errorName = '昵称已存在';\n                                    return false;\n\n                                }else if(err.status === 401){\n\n                                    this.errorSms = '验证码错误';\n                                    return false;\n\n                                }else if(err.status === 423){\n\n                                    this.errorSms = '验证码失效，请重新发送';\n                                    this.getCap('ruleForm','account');\n                                    return false;\n\n                                }\n\n                            });\n\n\t\t\t    \t\t}\n\n\t\t    \t\t});\n\t\t    \t}\n\n\n\t\t    }\n\n\t    }\n\n\t}\n</script>"]}]}