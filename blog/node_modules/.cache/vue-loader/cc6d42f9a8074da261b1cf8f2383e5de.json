{"remainingRequest":"/usr/local/var/www/blog/blog/node_modules/vue-loader/lib/index.js??vue-loader-options!/usr/local/var/www/blog/blog/src/components/User/index.vue?vue&type=style&index=0&scpoed=true&lang=scss&","dependencies":[{"path":"/usr/local/var/www/blog/blog/src/components/User/index.vue","mtime":1545054706895},{"path":"/usr/local/var/www/blog/blog/node_modules/css-loader/index.js","mtime":499162500000},{"path":"/usr/local/var/www/blog/blog/node_modules/vue-loader/lib/loaders/stylePostLoader.js","mtime":499162500000},{"path":"/usr/local/var/www/blog/blog/node_modules/postcss-loader/src/index.js","mtime":499162500000},{"path":"/usr/local/var/www/blog/blog/node_modules/sass-loader/lib/loader.js","mtime":1533139052000},{"path":"/usr/local/var/www/blog/blog/node_modules/cache-loader/dist/cjs.js","mtime":499162500000},{"path":"/usr/local/var/www/blog/blog/node_modules/vue-loader/lib/index.js","mtime":499162500000}],"contextDependencies":[],"result":["\n看见了吗?\n@import \"@/assets/css/user.scss\";\n",{"version":3,"sources":["index.vue"],"names":[],"mappings":";AACA;AACA","file":"index.vue","sourceRoot":"src/components/User","sourcesContent":["<style scpoed lang=\"scss\">\n看见了吗?\n@import \"@/assets/css/user.scss\";\n</style>\n\n<template>\n  <div id=\"user\"\n       v-loading=\"loading\">\n    <div id=\"user-head\">\n\n      <croppa class=\"user-backgroundImg\"\n              v-model=\"croppa\"\n              :width=width\n              :height=height\n              placeholder=\"选择背景图片\"\n              :placeholder-font-size=\"30\"\n              :disabled=\"false\"\n              accept=\"image/png,image/jpeg,image/jpg,image/gif\"\n              :prevent-white-space=\"true\"\n              :disable-scroll-to-zoom=\"true\"\n              disable-click-to-choose\n              :show-remove-button=\"false\"\n              @new-image-drawn=\"onNewImage\"\n              @zoom=\"onZoom\"\n              remove-button-color=\"#1DA1F2\">\n        <img :src='root+backimg'\n             slot=\"initial\">\n      </croppa>\n\n      <div id=\"user-head-foot\">\n\n        <div id=\"user-head-foot-main\">\n          <avatar class=\"\n             headPic\"\n                  :size=\"200\"\n                  :src='this.root+user.avatar'\n                  background-color=\"#1DA1F2\"\n                  :username=\"user.name || '' \"></avatar>\n\n          <div id=\"user-head-foot-nav\">\n\n            <div class=\"foot-nav-list\">\n              <i class=\"el-icon-edit-outline\"></i>\n              写的文章\n            </div>\n            <div class=\"foot-nav-list\">\n              <i class=\"el-icon-picture\"></i>\n              拍的照片\n            </div>\n            <div class=\"foot-nav-list\">\n              <i class=\"el-icon-picture\"></i>\n              关注了\n            </div>\n            <div class=\"foot-nav-list\">\n              <i class=\"el-icon-picture\"></i>\n              关注者\n            </div>\n            <input type=\"range\"\n                   @input=\"onSliderChange\"\n                   :min=\"sliderMin\"\n                   :max=\"sliderMax\"\n                   step=\".001\"\n                   v-model=\"sliderVal\">\n            <button @click=\"croppa.chooseFile()\">CHOOSE FILE...</button>\n            <button @click=\"upload\">UPLOAD</button>\n            <router-link to=\"/alterDetail\"\n                         id=\"edit-information-btn\"\n                         v-if=\"verbState && self.id == user.id\">编辑个人资料</router-link>\n\n            <div v-else\n                 id=\"follow-btn\">关注</div>\n\n          </div>\n        </div>\n      </div>\n    </div>\n\n    <div id=\"main-user\">\n      <div id=\"main-user-left\">\n\n        <div id=\"user-name\">\n          {{user.name}}\n        </div>\n\n        <div class=\"user-web\"\n             v-if=\"detail.web\">\n          个性站点： <a :href=\"detail.web\">{{detail.web}}</a>\n        </div>\n\n        <div class=\"user-detail\"\n             v-if=\"user.introduction\"> 一句话：{{user.introduction}} </div>\n        <div class=\"\"\n             v-else>\n          一句话：这个人很懒～还什么都没有留下～\n        </div>\n\n        <div class=\"user-detail\"\n             v-if=\"detail.occupation\">\n          职业经历: <span class=\"udr-line\">{{detail.occupation}}</span> </div>\n        <div class=\"user-detail\"\n             v-if=\"detail.education\">\n          教育经历: <span class=\"udr-line\">{{detail.education}}</span>\n        </div>\n        <div class=\"user-detail\"\n             v-if=\"detail.hobby\">\n          爱好: <span class=\"udr-line\">{{detail.hobby}}</span>\n        </div>\n      </div>\n\n      <div id=\"main-user-right\">\n\n      </div>\n\n    </div>\n  </div>\n</template>\n\n<script>\nimport { mapGetters } from 'vuex'\nexport default {\n  data () {\n    return {\n      state: null,\n      user: {},\n      detail: {},\n      loading: true,\n      width: 1600,\n      height: 230,\n      //初始化背景图插件\n      croppa: {},\n      //初始化图片滑动放大缩小inputrang\n      sliderVal: 0,\n      sliderMin: 0,\n      sliderMax: 0,\n      backimg: '',\n      root: '',\n    }\n  },\n  computed: {\n    ...mapGetters([\n      'verbState',//登录状态\n      'token',//登录的用户的token\n      'self',//获取当前登录的用户信息\n    ]),\n\n  },\n  created: function () {\n\n    //获取浏览器窗口的宽度 然后赋值给背景图片宽度\n    this.width = window.screen.width;\n    //判断是否登录\n    this.state = localStorage.getItem('verbState');\n    //获取路由传递过来的用户id\n    this.id = this.$route.params.id;\n\n    //数据\n    let paramsObj = {\n      id: this.id,\n    }\n    //发送axios 获取传递过来id对用的用户的数据\n    this.$server.getInformation(paramsObj).then(data => {\n      //获取到用户的基本信息\n      this.user = data;\n      //获取到用户的详细信息\n      this.detail = data.user_detail;\n      //判断用户是否有背景图片 且是否是本人页面 然后更改高度\n      //之所以使用定时器 是因为我别无他法 只能用定时器延迟然后获取数据\n      setTimeout(() => {\n        if (this.user.backgroundImg != null || this.user.id == this.self.id) {\n          this.height = 430;\n        }\n      }, 200);\n\n      // eslint-disable-next-line no-console\n      console.log(data);\n    }).catch(err => {\n      // eslint-disable-next-line no-console\n      console.log(err);\n    })\n  },\n  mounted: function () {\n    this.loading = false;\n    this.root = this.$URL;\n  },\n  methods: {\n    onFileTypeMismatch () {\n      this.$message({\n        message: '文件格式不对呦 😳',\n        type: 'warning',\n      })\n    },\n    onNewImage () {\n      this.sliderVal = this.croppa.scaleRatio\n      this.sliderMin = this.croppa.scaleRatio / 2\n      this.sliderMax = this.croppa.scaleRatio * 5\n    },\n\n    onSliderChange (evt) {\n      var increment = evt.target.value\n      this.croppa.scaleRatio = +increment\n    },\n\n    onZoom () {\n      // To prevent zooming out of range when using scrolling to zoom\n      // if (this.sliderMax && this.croppa.scaleRatio >= this.sliderMax) {\n      //   this.croppa.scaleRatio = this.sliderMax\n      // } else if (this.sliderMin && this.croppa.scaleRatio <= this.sliderMin) {\n      //   this.croppa.scaleRatio = this.sliderMin\n      // }\n\n      this.sliderVal = this.croppa.scaleRatio\n    },\n    upload () {\n\n      //判断是否有图片选中\n      if (!this.croppa.hasImage()) {\n        this.$message({\n          message: '你还没有选择图片 😳',\n          type: 'warning'\n        });\n\n        return false;\n      }\n\n      //获取到文件 但是是blob 二进制资源\n      this.croppa.generateBlob((blob) => {\n        console.log('bb', blob);\n        //二进制转文件\n        const file = new File([blob], 'backImg', {\n          type: 'image/jpeg',\n        });\n        var fd = new FormData()\n        fd.append('image', file);\n        fd.append('type', 'backgroundImg');\n\n        console.log('im', fd.get('image'));\n        this.$server.uploadImg(fd).then(data => {\n          console.log(data);\n        }).catch(err => {\n          console.log('err', err);\n        })\n\n\n        return false;\n      })\n    }\n\n  }\n}\n</script>"]}]}