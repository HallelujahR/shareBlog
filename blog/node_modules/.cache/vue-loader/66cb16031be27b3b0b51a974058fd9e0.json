{"remainingRequest":"/usr/local/var/www/blog/blog/node_modules/vue-loader/lib/index.js??vue-loader-options!/usr/local/var/www/blog/blog/src/components/loginOrRegister/login.vue?vue&type=style&index=0&lang=scss&","dependencies":[{"path":"/usr/local/var/www/blog/blog/src/components/loginOrRegister/login.vue","mtime":1543646422019},{"path":"/usr/local/var/www/blog/blog/node_modules/css-loader/index.js","mtime":499162500000},{"path":"/usr/local/var/www/blog/blog/node_modules/vue-loader/lib/loaders/stylePostLoader.js","mtime":499162500000},{"path":"/usr/local/var/www/blog/blog/node_modules/postcss-loader/src/index.js","mtime":499162500000},{"path":"/usr/local/var/www/blog/blog/node_modules/sass-loader/lib/loader.js","mtime":1533139052000},{"path":"/usr/local/var/www/blog/blog/node_modules/cache-loader/dist/cjs.js","mtime":499162500000},{"path":"/usr/local/var/www/blog/blog/node_modules/vue-loader/lib/index.js","mtime":499162500000}],"contextDependencies":[],"result":["\n@import '../../assets/css/login.scss';\n",{"version":3,"sources":["login.vue"],"names":[],"mappings":";AACA","file":"login.vue","sourceRoot":"src/components/loginOrRegister","sourcesContent":["<style type=\"scoped\" lang=\"scss\">\n@import '../../assets/css/login.scss';\n</style>\n\n<template>\n\t<div>\n\t\t<div id=\"login\">\n\t\t\t<div id=\"login-title\">\n\t\t\t\t登录流域\n\t\t\t</div>\n\t\t\t<el-form :model=\"ruleForm\" :rules=\"rules\" ref=\"ruleForm\" class=\"demo-ruleForm\">\n\t\t\t\t<div class=\"login-user\">\n\t\t\t\t\t<el-form-item prop=\"account\" :error=\"errorMsg\" >\n\t\t\t\t\t\t<el-input\n\t\t\t\t\t\t    placeholder=\"输入账号\"\n\t\t\t\t\t\t    suffix-icon=\"el-icon-phone\"\n\t\t\t\t\t\t    v-model=\"ruleForm.account\"\n\t\t\t\t\t\t    id=\"login-user-input\"\n\t\t\t\t\t\t    >\n\t\t\t\t\t\t</el-input>\n\t\t\t\t\t</el-form-item>\n\t\t\t\t</div>\n\t\t\t\t<div class=\"login-user\">\n\t\t\t\t\t<el-form-item prop=\"password\">\n\t\t\t\t\t\t<el-input\n\t\t\t\t\t\t    placeholder=\"输入密码\"\n\t\t\t\t\t\t    suffix-icon=\"el-icon-edit\"\n\t\t\t\t\t\t    v-model=\"ruleForm.password\"\n\t\t\t\t\t\t    id=\"login-user-input2\"\n\t\t\t\t\t\t    type=\"password\"\n\t\t\t\t\t\t    >\n\t\t\t\t\t\t</el-input>\n\t\t\t\t\t</el-form-item>\n\t\t\t\t</div>\n\n\t\t\t\t<div class=\"login-user\">\n\t\t\t\t\t<el-form-item>\n\t\t\t\t    \t<el-button class=\"login-btn\" type=\"primary\" @click=\"submitForm('ruleForm')\">立即登录</el-button>\n\t\t\t\t    \t<div class=\"register\">找回密码</div>\n\t\t\t\t    \t<div class=\"register\" @click=\"register()\" style=\"margin-left:200px;\">还没有账号？立即注册</div>\n\t\t\t\t    </el-form-item>\n\t\t\t\t</div>\n\t\t\t</el-form>\n\n\t\t\t<div id=\"login-ds\">\n\t\t\t\t<span style=\"float:left\">第三方登录:</span>\n\t\t\t\t<img class=\"login-icon\" src=\"../../assets/qqicon.png\" />\n\t\t\t\t<img class=\"login-icon\" src=\"../../assets/weibo.png\" />\n\t\t\t</div>\n\t\t\t<div v-if=\"verbState\">\n\t\t\t\t{{verbState}}\n\t\t\t</div>\n\t\t</div>\n\t</div>\n</template>\n\n<script>\nimport { mapState, mapMutations, mapActions } from 'vuex'\n\n\texport default {\n        data: function () {\n            return {\n                show: false,\n                ruleForm: {\n                    account: '',\n                    password: '',\n                },\n                errorMsg:'',\n                rules: {\n                    account: [\n                        {required: true, message: '请输入账号', trigger: 'blur'},\n                        {min: 3, max: 20, message: '长度在 3 到 20 个字符', trigger: 'blur'}\n                    ],\n                    password: [\n                        {required: true, message: '请输入密码', trigger: 'blur'},\n                        {min: 3, max: 20, message: '长度在 3 到 20 个字符', trigger: 'blur'}\n                    ],\n                }\n            }\n        },\n\t\tcomputed:{\n\t\t\t...mapState([\n\t\t\t\t\"verbState\"\n\t\t\t]),\n\t\t\t...mapActions([\n\t\t\t\t\"setUser\",\n\t\t\t]),\n\n\t\t},\n\t    mounted:function(){\n\t        setTimeout(function(){ this.show = true} ,200);\n\t\t\tif(localStorage.relogin === 'true'){\n                this.$message({\n                    message: '登录过期，请重新登录',\n                    type: 'warning'\n                });\n                localStorage.removeItem('relogin')\n\t\t\t}\n\t    },\n\t    methods:{\n            ...mapMutations({\n                setverbState: 'SET_VERBSTATE',\n                setToken: 'SET_TOKEN',\n            }),\n\n            submitForm: function (formName) {\n\t\t\t\tthis.errorMsg = '';\n                this.$refs[formName].validate((valid) => {\n\n\n                    if (valid) {\n\n                        let paramObj = {\n                            username: this.ruleForm.account,\n                            password: this.ruleForm.password,\n                        };\n                        // console.log(this.$server);\n                        this.$server.login(paramObj).then(data => {\n\t\t\t\t\t\t\t// console.log(data);\n                            //用户的token\n                            const token = data.access_token;\n\n                            //使用localStorage 存储登录信息\n                            localStorage.setItem('access_token', token);\n                            localStorage.setItem('verbState', 'true');\n\n                            //把登录后的token 存储在vuex 中\n                            this.setverbState(true);\n                            this.setToken(token);\n\n                            //获取用户信息\n                            this.setUser;\n\n                            //登录成功后的提示信息\n                            this.$message({\n                                message: '登录成功，开始您的流域',\n                                type: 'success'\n                            });\n\n                            //登录成功跳转到首页\n                            this.$router.push({name: 'index'})\n\n                        })\n\t\t\t\t\t\t.catch(err => {\n\n                            if (err.status === 401) {\n\n                                this.errorMsg = '用户或密码错误';\n                                return false;\n\n                            }\n\t\t\t\t\t\t})\n\n                    } else {\n                        console.log('error submit!!');\n                        return false;\n                    }\n                });\n            },\n            resetForm: function (formName) {\n                this.$refs[formName].resetFields();\n            },\n\t\t    register() {\n\t\t    \tthis.$emit('reg',true);\n\t\t    },\n\t\t    //获取用户数据\n\n\t    }\n\n\t}\n</script>"]}]}