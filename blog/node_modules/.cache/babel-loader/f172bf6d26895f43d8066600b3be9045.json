{"remainingRequest":"/usr/local/var/www/blog/blog/node_modules/thread-loader/dist/cjs.js!/usr/local/var/www/blog/blog/node_modules/babel-loader/lib/index.js!/usr/local/var/www/blog/blog/node_modules/cache-loader/dist/cjs.js??ref--0-0!/usr/local/var/www/blog/blog/node_modules/vue-loader/lib/index.js??vue-loader-options!/usr/local/var/www/blog/blog/src/components/User/index.vue?vue&type=script&lang=js&","dependencies":[{"path":"/usr/local/var/www/blog/blog/src/components/User/index.vue","mtime":1547790966345},{"path":"/usr/local/var/www/blog/blog/node_modules/cache-loader/dist/cjs.js","mtime":499162500000},{"path":"/usr/local/var/www/blog/blog/node_modules/thread-loader/dist/cjs.js","mtime":499162500000},{"path":"/usr/local/var/www/blog/blog/node_modules/babel-loader/lib/index.js","mtime":499162500000},{"path":"/usr/local/var/www/blog/blog/node_modules/cache-loader/dist/cjs.js","mtime":499162500000},{"path":"/usr/local/var/www/blog/blog/node_modules/vue-loader/lib/index.js","mtime":499162500000}],"contextDependencies":[],"result":["import \"core-js/modules/es6.string.ends-with\";\nimport _objectSpread from \"/usr/local/var/www/blog/blog/node_modules/@babel/runtime/helpers/esm/objectSpread\";\nimport \"core-js/modules/es6.array.iterator\";\nimport \"core-js/modules/es6.promise\";\nimport \"core-js/modules/es7.promise.finally\";\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\nimport { mapGetters, mapMutations } from 'vuex';\nexport default {\n  data: function data() {\n    return {\n      state: false,\n      //åˆ¤æ–­æ˜¯ä¸æ˜¯æœ¬äºº\n      user: {},\n      //ç”¨æˆ·åŸºæœ¬ä¿¡æ¯\n      detail: {},\n      //ç”¨æˆ·è¯¦æƒ…\n      loading: true,\n      width: '',\n      height: 230,\n      //åˆå§‹åŒ–èƒŒæ™¯å›¾æ’ä»¶\n      croppa: {},\n      //åˆå§‹åŒ–å›¾ç‰‡æ»‘åŠ¨æ”¾å¤§ç¼©å°input range\n      sliderVal: 0,\n      sliderMin: 0,\n      sliderMax: 0,\n      root: '',\n      //ç½‘ç«™apiæ ¹ç›®å½•\n      alterImgFlag: true,\n      //æ˜¯å¦å‡ºçŽ°å¤„ç†èƒŒæ™¯å›¾ç‰‡æŒ‰é’®\n      freshFlag: false,\n      //åˆ¤æ–­æ˜¯å¦ä¸Šä¼ è¿‡å›¾ç‰‡\n      alterDetail: true,\n      //è·³è½¬åˆ°ç¼–è¾‘ä¸ªäººèµ„æ–™å¼€å…³\n      cursorFlag: false,\n      //æŽ§åˆ¶é¼ æ ‡åœ¨èƒŒæ™¯å›¾ä¸Šçš„æ ·å¼\n      centerDialogVisible: false //ä¿®æ”¹å¤´åƒçš„å¯¹è¯æ¡†æŽ§åˆ¶\n\n    };\n  },\n  computed: _objectSpread({}, mapGetters(['verbState', //ç™»å½•çŠ¶æ€\n  'token', //ç™»å½•çš„ç”¨æˆ·çš„token\n  'self'])),\n  //ç›‘å¬è·¯ç”±å˜åŒ–\n  watch: {\n    $route: function $route() {\n      //èŽ·å–ç½‘é¡µurlåˆ¤æ–­æ˜¯å¦åœ¨æ›´æ”¹è¯¦æƒ…é¡µé¢\n      if (this.$route.path.endsWith('alterDetail')) this.alterDetail = false;\n    }\n  },\n  created: function created() {\n    var _this = this;\n\n    //èŽ·å–æµè§ˆå™¨çª—å£çš„å®½åº¦ ç„¶åŽèµ‹å€¼ç»™èƒŒæ™¯å›¾ç‰‡å®½åº¦\n    this.width = window.screen.width; //åˆ¤æ–­æ˜¯å¦ç™»å½•\n\n    this.state = localStorage.getItem('verbState'); //èŽ·å–è·¯ç”±ä¼ é€’è¿‡æ¥çš„ç”¨æˆ·id\n\n    this.id = this.$route.params.id; //æ•°æ®\n\n    var paramsObj = {\n      id: this.id //å‘é€axios èŽ·å–ä¼ é€’è¿‡æ¥idå¯¹ç”¨çš„ç”¨æˆ·çš„æ•°æ®\n\n    };\n    this.$server.getInformation(paramsObj).then(function (data) {\n      //èŽ·å–åˆ°ç”¨æˆ·çš„åŸºæœ¬ä¿¡æ¯\n      _this.user = data; //èŽ·å–åˆ°ç”¨æˆ·çš„è¯¦ç»†ä¿¡æ¯\n\n      _this.detail = data.user_detail; //åˆ¤æ–­ç”¨æˆ·æ˜¯å¦æœ‰èƒŒæ™¯å›¾ç‰‡ ä¸”æ˜¯å¦æ˜¯æœ¬äººé¡µé¢ ç„¶åŽæ›´æ”¹é«˜åº¦\n      //ä¹‹æ‰€ä»¥ä½¿ç”¨å®šæ—¶å™¨ æ˜¯å› ä¸ºæˆ‘åˆ«æ— ä»–æ³• åªèƒ½ç”¨å®šæ—¶å™¨å»¶è¿Ÿç„¶åŽèŽ·å–æ•°æ®\n\n      setTimeout(function () {\n        if (_this.user.backgroundImg != null || _this.user.id == _this.self.id) {\n          _this.state = true;\n          _this.height = 430;\n        }\n      }, 200);\n    }).catch(function (err) {\n      // eslint-disable-next-line no-console\n      console.log(err);\n    });\n  },\n  mounted: function mounted() {\n    //ç½‘é¡µåŠ è½½çŠ¶æ€\n    this.loading = false; //apiåœ°å€\n\n    this.root = this.$URL; //èŽ·å–ç½‘é¡µurlåˆ¤æ–­æ˜¯å¦åœ¨æ›´æ”¹è¯¦æƒ…é¡µé¢\n\n    if (this.$route.path.endsWith('alterDetail')) this.alterDetail = false;\n  },\n  methods: _objectSpread({}, mapMutations({\n    setuser: 'SET_USER'\n  }), {\n    onFileTypeMismatch: function onFileTypeMismatch() {\n      this.$message({\n        message: 'æ–‡ä»¶æ ¼å¼ä¸å¯¹å‘¦ ðŸ˜³',\n        type: 'warning'\n      });\n    },\n    onNewImage: function onNewImage() {\n      this.sliderVal = this.croppa.scaleRatio;\n      this.sliderMin = this.croppa.scaleRatio / 2;\n      this.sliderMax = this.croppa.scaleRatio * 5;\n    },\n    onSliderChange: function onSliderChange(evt) {\n      var increment = evt.target.value;\n      this.croppa.scaleRatio = +increment;\n    },\n    onZoom: function onZoom() {\n      // To prevent zooming out of range when using scrolling to zoom\n      // if (this.sliderMax && this.croppa.scaleRatio >= this.sliderMax) {\n      //   this.croppa.scaleRatio = this.sliderMax\n      // } else if (this.sliderMin && this.croppa.scaleRatio <= this.sliderMin) {\n      //   this.croppa.scaleRatio = this.sliderMin\n      // }\n      this.sliderVal = this.croppa.scaleRatio;\n    },\n    upload: function upload() {\n      var _this2 = this;\n\n      //åˆ¤æ–­æ˜¯å¦æœ‰å›¾ç‰‡é€‰ä¸­\n      if (!this.croppa.hasImage()) {\n        this.$message({\n          message: 'ä½ è¿˜æ²¡æœ‰é€‰æ‹©å›¾ç‰‡ ðŸ˜³',\n          type: 'warning'\n        });\n        return false;\n      } //èŽ·å–åˆ°æ–‡ä»¶ ä½†æ˜¯æ˜¯blob äºŒè¿›åˆ¶èµ„æº\n\n\n      this.croppa.generateBlob(function (blob) {\n        //äºŒè¿›åˆ¶è½¬æ–‡ä»¶\n        var file = new File([blob], 'backImg', {\n          type: 'image/jpeg'\n        });\n        var fd = new FormData();\n        fd.append('image', file);\n        fd.append('type', 'backgroundImg'); //å‘é€axiosæ›´æ”¹å›¾ç‰‡\n\n        _this2.$server.uploadImg(fd).then(function (data) {\n          //æ›´æ”¹é»˜è®¤å›¾ç‰‡è·¯å¾„\n          _this2.detail.backgroundImg = data; //æ›´æ”¹æŒ‰é’®çŠ¶æ€\n\n          _this2.alterImgFlag = !_this2.alterImgFlag; //ä¸Šä¼ æˆåŠŸæç¤º\n\n          _this2.$message({\n            type: 'success',\n            message: 'ä¸Šä¼ æˆåŠŸ ðŸ˜Š'\n          });\n        }).catch(function (err) {\n          // eslint-disable-next-line no-console\n          console.log('err', err);\n        });\n\n        return false;\n      });\n    },\n    alterImg: function alterImg() {\n      this.alterImgFlag = !this.alterImgFlag;\n      this.cursorFlag = !this.cursorFlag;\n      this.croppa.refresh();\n    },\n    removeBackgroundImg: function removeBackgroundImg() {\n      var _this3 = this;\n\n      this.$confirm('ç§»é™¤èƒŒæ™¯, æ˜¯å¦ç»§ç»­?', 'æç¤º', {\n        confirmButtonText: 'ç¡®å®š',\n        cancelButtonText: 'å–æ¶ˆ',\n        type: 'warning'\n      }).then(function () {\n        //å‚æ•°\n        var paramsObj = {\n          type: 'backgroundImg' //å‘é€axios åˆ é™¤å›¾ç‰‡\n\n        };\n\n        _this3.$server.deleteImg(paramsObj).then(function (data) {\n          if (data == 2) {\n            _this3.$message({\n              type: 'warning',\n              message: 'è¿˜æ²¡æœ‰èƒŒæ™¯å›¾ ðŸ˜“'\n            });\n\n            return false;\n          } //æ›´æ”¹é»˜è®¤å›¾ç‰‡è·¯å¾„\n\n\n          _this3.detail.backgroundImg = ''; //è§¦å‘æ’ä»¶ç§»é™¤\n\n          _this3.croppa.remove(); //æˆåŠŸæç¤º\n\n\n          _this3.$message({\n            type: 'success',\n            message: 'ç§»é™¤æˆåŠŸ!'\n          }); //æ›´æ”¹æŒ‰é’®çŠ¶æ€\n\n\n          _this3.alterImgFlag = !_this3.alterImgFlag;\n        }).catch(function (err) {\n          // eslint-disable-next-line no-console\n          console.log(err);\n        });\n      }).catch(function () {\n        _this3.$message({\n          type: 'info',\n          message: 'å·²å–æ¶ˆ'\n        });\n      });\n    },\n    alterDetails: function alterDetails() {\n      this.alterDetail = !this.alterDetail;\n    },\n    //æ›´æ”¹å¤´åƒçš„croppa æ›´æ”¹ä¸ºåœ†åœˆ\n    onInit: function onInit() {\n      this.croppa.addClipPlugin(function (ctx, x, y, w, h) {\n        /*\n         * ctx: canvas context\n         * x: start point (top-left corner) x coordination\n         * y: start point (top-left corner) y coordination\n         * w: croppa width\n         * h: croppa height\n        */\n        ctx.beginPath();\n        ctx.arc(x + w / 2, y + h / 2, w / 2, 0, 2 * Math.PI, true);\n        ctx.closePath();\n      });\n    },\n    //ä¸Šä¼ å¤´åƒçš„æ–¹æ³•\n    uploadAvatar: function uploadAvatar() {\n      var _this4 = this;\n\n      //åˆ¤æ–­æ˜¯å¦æœ‰å›¾ç‰‡é€‰ä¸­\n      if (!this.croppa.hasImage()) {\n        this.$message({\n          message: 'ä½ è¿˜æ²¡æœ‰é€‰æ‹©å›¾ç‰‡ ðŸ˜³',\n          type: 'warning'\n        });\n        return false;\n      } //èŽ·å–åˆ°æ–‡ä»¶ ä½†æ˜¯æ˜¯blob äºŒè¿›åˆ¶èµ„æº\n\n\n      this.croppa.generateBlob(function (blob) {\n        //äºŒè¿›åˆ¶è½¬æ–‡ä»¶\n        var file = new File([blob], 'backImg', {\n          type: 'image/jpeg'\n        });\n        var fd = new FormData();\n        fd.append('image', file);\n        fd.append('type', 'avatar'); //å‘é€axiosæ›´æ”¹å›¾ç‰‡\n\n        _this4.$server.uploadImg(fd).then(function (data) {\n          if (data == 2) {\n            //ä¸Šä¼ å¤±è´¥æç¤º\n            _this4.$message({\n              type: 'success',\n              message: 'ä¸Šä¼ å¤±è´¥ ðŸ˜“'\n            });\n\n            return false;\n          } //ä¸Šä¼ æˆåŠŸæç¤º\n\n\n          _this4.$message({\n            type: 'success',\n            message: 'ä¸Šä¼ æˆåŠŸ ðŸ˜Š'\n          }); //æ›´æ”¹é»˜è®¤å›¾ç‰‡è·¯å¾„\n\n\n          _this4.user.avatar = data;\n\n          _this4.setuser(_this4.user);\n\n          _this4.centerDialogVisible = false; //ä¿®æ”¹å¤´åƒçš„å¯¹è¯æ¡†æŽ§åˆ¶\n        }).catch(function (err) {\n          // eslint-disable-next-line no-console\n          console.log('err', err);\n        });\n\n        return false;\n      });\n    },\n    //ç‚¹å‡»å–æ¶ˆä¿®æ”¹å¤´åƒæŒ‰é’®\n    noEditAvatar: function noEditAvatar() {\n      this.croppa.refresh();\n    },\n    //ç§»é™¤å¤´åƒ\n    removeAvatarImg: function removeAvatarImg() {\n      var _this5 = this;\n\n      this.$confirm('ç§»é™¤èƒŒæ™¯å¤´åƒ, æ˜¯å¦ç»§ç»­?', 'æç¤º', {\n        confirmButtonText: 'ç¡®å®š',\n        cancelButtonText: 'å–æ¶ˆ',\n        type: 'warning'\n      }).then(function () {\n        //å‚æ•°\n        var paramsObj = {\n          type: 'avatar' //å‘é€axios åˆ é™¤å›¾ç‰‡\n\n        };\n\n        _this5.$server.deleteImg(paramsObj).then(function (data) {\n          if (data == 2) {\n            _this5.$message({\n              type: 'warning',\n              message: 'è¿˜æ²¡æœ‰å¤´åƒ ðŸ˜“'\n            });\n\n            return false;\n          } //æ›´æ”¹é»˜è®¤å›¾ç‰‡è·¯å¾„\n\n\n          _this5.user.avatar = ''; //è§¦å‘æ’ä»¶ç§»é™¤\n\n          _this5.croppa.remove(); //æˆåŠŸæç¤º\n\n\n          _this5.$message({\n            type: 'success',\n            message: 'ç§»é™¤æˆåŠŸ!'\n          });\n\n          _this5.user.avatar = '';\n\n          _this5.setuser(_this5.user);\n        }).catch(function (err) {\n          // eslint-disable-next-line no-console\n          console.log(err);\n        });\n      }).catch(function () {\n        _this5.$message({\n          type: 'info',\n          message: 'å·²å–æ¶ˆ'\n        });\n      });\n    }\n  })\n};",null]}