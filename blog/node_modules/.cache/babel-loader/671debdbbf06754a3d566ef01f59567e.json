{"remainingRequest":"/usr/local/var/www/blog/blog/node_modules/babel-loader/lib/index.js!/usr/local/var/www/blog/blog/node_modules/eslint-loader/index.js??ref--13-0!/usr/local/var/www/blog/blog/src/providers/intercept.js","dependencies":[{"path":"/usr/local/var/www/blog/blog/src/providers/intercept.js","mtime":1543562325989},{"path":"/usr/local/var/www/blog/blog/node_modules/cache-loader/dist/cjs.js","mtime":499162500000},{"path":"/usr/local/var/www/blog/blog/node_modules/babel-loader/lib/index.js","mtime":499162500000},{"path":"/usr/local/var/www/blog/blog/node_modules/eslint-loader/index.js","mtime":499162500000}],"contextDependencies":[],"result":["import \"core-js/modules/es6.string.starts-with\";\nimport \"core-js/modules/es6.array.iterator\";\nimport \"core-js/modules/es6.promise\";\nimport \"core-js/modules/es7.promise.finally\";\n\nvar _this = this;\n\nimport axios from \"axios/index\";\nimport qs from 'qs';\nimport router from '../router';\nimport store from '../store';\nimport { SET_VERBSTATE } from \"../store/mutation-types\";\nimport Vue from 'vue';\nimport ElementUI from 'element-ui'; //引入element ui\n\nimport 'element-ui/lib/theme-chalk/index.css';\nVue.use(ElementUI);\naxios.defaults.timeout = 5000;\naxios.defaults.baseURL = 'http://api.blog.com'; //填写域名\n//http request 拦截器\n\naxios.interceptors.request.use(function (config) {\n  config.headers = {\n    'Content-Type': 'application/x-www-form-urlencoded'\n  }; //判断提交上来的方法 题爱奥过来的数据需要序列化才能被后端处理\n\n  if (config.method.toLocaleLowerCase() === 'post' || config.method.toLocaleLowerCase() === 'put' || config.method.toLocaleLowerCase() === 'delete') {\n    config.data = qs.stringify(config.data);\n  } //判断token是否存在\n\n\n  if (localStorage.access_token) {\n    //判断token 的格式 因为新的token和旧的token返回的字符串不同\n    if (localStorage.access_token.startsWith('Bearer')) {\n      config.headers.Authorization = localStorage.access_token;\n    } else {\n      config.headers.Authorization = 'Bearer ' + localStorage.access_token;\n    }\n  }\n\n  return config;\n}, function (error) {\n  return Promise.reject(err);\n}); //响应拦截器即异常处理\n\naxios.interceptors.response.use(function (response) {\n  var token = response.headers.authorization;\n\n  if (token) {\n    // 如果 header 中存在 token，那么触发 refreshToken 方法，替换本地的 token\n    localStorage.access_token = token;\n  }\n\n  return response;\n}, function (err) {\n  if (err && err.response) {\n    switch (err.response.status) {\n      case 400:\n        console.log('错误请求');\n        break;\n\n      case 401:\n        localStorage.verbState = 'false';\n        store.commit('SET_VERBSTATE', false);\n        store.commit('SET_TOKEN', '');\n        router.push({\n          name: 'logReg'\n        });\n        console.log('未授权，请重新登录');\n        break;\n\n      case 403:\n        console.log('拒绝访问');\n        break;\n\n      case 404:\n        console.log('请求错误,未找到该资源');\n        break;\n\n      case 405:\n        console.log('请求方法未允许');\n        break;\n\n      case 408:\n        console.log('请求超时');\n        break;\n\n      case 500:\n        //登录成功后的提示信息\n        console.log(ElementUI);\n        console.log(_this);\n        ElementUI.$message({\n          message: '登录成功，开始您的流域',\n          type: 'success'\n        });\n        alert(登录过期);\n        console.log('服务器端出错');\n        break;\n\n      case 501:\n        console.log('网络未实现');\n        break;\n\n      case 502:\n        console.log('网络错误');\n        break;\n\n      case 503:\n        console.log('服务不可用');\n        break;\n\n      case 504:\n        console.log('网络超时');\n        break;\n\n      case 505:\n        console.log('http版本不支持该请求');\n        break;\n\n      default:\n        console.log(\"\".concat(err.response.status));\n    }\n  } else {\n    console.log('连接到服务器失败');\n  }\n\n  return Promise.reject(err.response); // return Promise.resolve()\n});",{"version":3,"sources":["/usr/local/var/www/blog/blog/src/providers/intercept.js"],"names":["axios","qs","router","store","SET_VERBSTATE","Vue","ElementUI","use","defaults","timeout","baseURL","interceptors","request","config","headers","method","toLocaleLowerCase","data","stringify","localStorage","access_token","startsWith","Authorization","error","Promise","reject","err","response","token","authorization","status","console","log","verbState","commit","push","name","$message","message","type","alert","登录过期"],"mappings":"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","sourcesContent":["import axios from \"axios/index\";\nimport qs from 'qs';\nimport router from '../router'\nimport store from '../store'\nimport {SET_VERBSTATE} from \"../store/mutation-types\";\n\nimport Vue from 'vue'\nimport ElementUI from 'element-ui';//引入element ui\nimport 'element-ui/lib/theme-chalk/index.css';\nVue.use(ElementUI);\n\naxios.defaults.timeout = 5000;\naxios.defaults.baseURL ='http://api.blog.com'; //填写域名\n\n//http request 拦截器\naxios.interceptors.request.use(\n    config => {\n\n        config.headers = {\n            'Content-Type':'application/x-www-form-urlencoded'\n        };\n\n        //判断提交上来的方法 题爱奥过来的数据需要序列化才能被后端处理\n        if (config.method.toLocaleLowerCase() === 'post'\n            || config.method.toLocaleLowerCase() === 'put'\n            || config.method.toLocaleLowerCase() === 'delete') {\n\n            config.data = qs.stringify(config.data)\n        }\n\n        //判断token是否存在\n        if (localStorage.access_token) {\n            //判断token 的格式 因为新的token和旧的token返回的字符串不同\n            if(localStorage.access_token.startsWith('Bearer')){\n                config.headers.Authorization = localStorage.access_token;\n            }else{\n                config.headers.Authorization = 'Bearer ' + localStorage.access_token;\n            }\n        }\n\n        return config;\n    },\n    error => {\n        return Promise.reject(err);\n    }\n);\n\n//响应拦截器即异常处理\naxios.interceptors.response.use(response => {\n\n    var token = response.headers.authorization;\n\n    if (token) {\n        // 如果 header 中存在 token，那么触发 refreshToken 方法，替换本地的 token\n        localStorage.access_token = token;\n\n    }\n\n    return response;\n\n}, err => {\n    if (err && err.response) {\n        switch (err.response.status) {\n            case 400:\n                console.log('错误请求')\n                break;\n            case 401:\n                localStorage.verbState = 'false';\n                store.commit('SET_VERBSTATE',false);\n                store.commit('SET_TOKEN','');\n                router.push({name: 'logReg'});\n\n                console.log('未授权，请重新登录');\n                break;\n            case 403:\n                console.log('拒绝访问')\n                break;\n            case 404:\n                console.log('请求错误,未找到该资源')\n                break;\n            case 405:\n                console.log('请求方法未允许')\n                break;\n            case 408:\n                console.log('请求超时')\n                break;\n            case 500:\n                //登录成功后的提示信息\n                console.log(ElementUI);\n                console.log(this);\n                ElementUI.$message({\n                    message: '登录成功，开始您的流域',\n                    type: 'success'\n                });\n                alert(登录过期);\n                console.log('服务器端出错')\n                break;\n            case 501:\n                console.log('网络未实现')\n                break;\n            case 502:\n                console.log('网络错误')\n                break;\n            case 503:\n                console.log('服务不可用')\n                break;\n            case 504:\n                console.log('网络超时')\n                break;\n            case 505:\n                console.log('http版本不支持该请求');\n                break;\n            default:\n                console.log(`${err.response.status}`)\n        }\n    } else {\n        console.log('连接到服务器失败')\n    }\n    return Promise.reject(err.response);\n    // return Promise.resolve()\n});\n\n"]}]}