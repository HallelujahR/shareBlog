(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-4a7914d4"],{"10f1":function(t,e,a){"use strict";var i=a("42d5"),n=a.n(i);n.a},"345a":function(t,e,a){"use strict";a.r(e);var i=function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",{directives:[{name:"loading",rawName:"v-loading",value:t.loading,expression:"loading"}],attrs:{id:"user"}},[a("div",{attrs:{id:"user-head"}},[a("croppa",{staticClass:"user-backgroundImg",style:t.cursorFlag?"cursor:move":"cursor:default",attrs:{width:t.width,height:t.height,placeholder:"背景图片 😲","placeholder-font-size":30,disabled:!1,accept:"image/png,image/jpeg,image/jpg,image/gif","prevent-white-space":!0,"disable-scroll-to-zoom":!0,"disable-click-to-choose":"","show-remove-button":!1,"remove-button-color":"#1DA1F2"},on:{"new-image-drawn":t.onNewImage,zoom:t.onZoom},model:{value:t.croppa,callback:function(e){t.croppa=e},expression:"croppa"}},[a("img",{attrs:{slot:"initial",crossOrigin:"anonymous",width:t.width,src:t.detail.backgroundImg?t.root+t.detail.backgroundImg:""},slot:"initial"}),t.alterImgFlag&t.state?a("el-button",{attrs:{round:"",id:"alterImg"},on:{click:function(e){t.alterImg()}}},[t._v("编辑图片")]):t._e()],1),a("div",{style:{width:t.width+"px"},attrs:{id:"user-head-foot"}},[a("div",{attrs:{id:"user-head-foot-main"}},[a("el-dropdown",[a("span",{staticClass:"el-dropdown-link HeadPicSpan"},[a("avatar",{staticClass:"headPic",attrs:{size:200,src:t.user.avatar?this.root+t.user.avatar:"","background-color":"#1DA1F2",username:t.user.name||""}})],1),a("el-dropdown-menu",{attrs:{slot:"dropdown"},slot:"dropdown"},[a("el-dropdown-item",[a("span",{on:{click:function(e){t.centerDialogVisible=!0}}},[a("i",{staticClass:"el-icon-picture-outline"}),t._v(" 修改头像")])])],1)],1),a("transition",{attrs:{mode:"out-in",name:"slide-fade"}},[t.alterImgFlag?a("div",{key:"usernav",attrs:{id:"user-head-foot-nav"}},[a("div",{staticClass:"foot-nav-list"},[a("i",{staticClass:"el-icon-edit-outline"}),t._v("\n              写的文章\n            ")]),a("div",{staticClass:"foot-nav-list"},[a("i",{staticClass:"el-icon-picture"}),t._v("\n              拍的照片\n            ")]),a("div",{staticClass:"foot-nav-list"},[t._v("\n              关注了\n            ")]),a("div",{staticClass:"foot-nav-list"},[t._v("\n              关注者\n            ")]),t.alterDetail?a("span",[t.verbState&&t.self.id==t.user.id?a("router-link",{attrs:{to:"/user/"+t.user.id+"/alterDetail",id:"edit-information-btn"},nativeOn:{click:function(e){t.alterDetails()}}},[t._v("编辑个人资料")]):a("div",{attrs:{id:"follow-btn"}},[t._v("关注")])],1):a("span",[t.verbState&&t.self.id==t.user.id?a("router-link",{attrs:{to:"/user/"+t.user.id,id:"edit-information-btn"},nativeOn:{click:function(e){t.alterDetails()}}},[t._v("取消")]):a("div",{attrs:{id:"follow-btn"}},[t._v("关注")])],1)]):a("div",{key:"img",attrs:{id:"user-head-foot-nav-alterImg"}},[a("input",{directives:[{name:"model",rawName:"v-model",value:t.sliderVal,expression:"sliderVal"}],staticClass:"user-head-foot-nav-alterImg_btn",attrs:{type:"range",id:"range",min:t.sliderMin,max:t.sliderMax,step:".001"},domProps:{value:t.sliderVal},on:{input:t.onSliderChange,__r:function(e){t.sliderVal=e.target.value}}}),a("el-button",{staticClass:"user-head-foot-nav-alterImg_btn",attrs:{round:"",plain:""},on:{click:function(e){t.croppa.chooseFile()}}},[t._v("选择背景")]),a("el-button",{staticClass:"user-head-foot-nav-alterImg_btn",attrs:{type:"primary",round:"",plain:""},on:{click:t.upload}},[t._v("保存")]),a("el-button",{staticClass:"user-head-foot-nav-alterImg_btn",attrs:{type:"info",round:""},on:{click:function(e){t.alterImg()}}},[t._v("取消")]),a("el-button",{staticClass:"user-head-foot-nav-alterImg_btn",attrs:{type:"danger",icon:"el-icon-delete",circle:""},on:{click:function(e){t.removeBackgroundImg()}}})],1)])],1)])],1),a("transition",{attrs:{mode:"out-in",name:"slide-fade"}},[a("router-view")],1),a("el-dialog",{attrs:{title:"更改头像",visible:t.centerDialogVisible,width:"40%",center:""},on:{"update:visible":function(e){t.centerDialogVisible=e}}},[a("center",[a("croppa",{staticClass:"user-backgroundImg changeAvatar",attrs:{width:208,height:208,placeholder:"Avatar 😎","placeholder-color":"white","placeholder-font-size":30,disabled:!1,accept:"image/png,image/jpeg,image/jpg,image/gif","prevent-white-space":!0,"disable-scroll-to-zoom":!0,"disable-click-to-choose":"","show-remove-button":!1},on:{"new-image-drawn":t.onNewImage,init:t.onInit,zoom:t.onZoom},model:{value:t.croppa,callback:function(e){t.croppa=e},expression:"croppa"}},[a("img",{attrs:{slot:"initial",crossOrigin:"anonymous",width:t.width,src:t.user.avatar?t.root+t.user.avatar:""},slot:"initial"})]),a("div",{attrs:{id:"changeAvatarBtn"}},[a("el-button",{staticClass:"user-head-foot-nav-alterImg_btn",attrs:{round:"",plain:""},on:{click:function(e){t.croppa.chooseFile()}}},[t._v("选择图片")]),a("input",{directives:[{name:"model",rawName:"v-model",value:t.sliderVal,expression:"sliderVal"}],staticClass:"user-head-foot-nav-alterImg_btn",attrs:{type:"range",id:"range",min:t.sliderMin,max:t.sliderMax,step:".001"},domProps:{value:t.sliderVal},on:{input:t.onSliderChange,__r:function(e){t.sliderVal=e.target.value}}}),a("el-button",{staticClass:"user-head-foot-nav-alterImg_btn",attrs:{type:"primary",round:"",plain:""},on:{click:t.uploadAvatar}},[t._v("保存")]),a("el-button",{staticClass:"user-head-foot-nav-alterImg_btn",attrs:{type:"info",round:""},on:{click:function(e){t.centerDialogVisible=!1,t.noEditAvatar()}}},[t._v("取消")]),a("el-button",{staticClass:"user-head-foot-nav-alterImg_btn",attrs:{type:"danger",icon:"el-icon-delete",circle:""},on:{click:function(e){t.removeAvatarImg()}}})],1)],1)],1)],1)},n=[],s=(a("aef6"),a("be94")),o=(a("cadf"),a("551c"),a("097d"),a("2f62")),r={data:function(){return{state:!1,user:{},detail:{},loading:!0,width:"",height:230,croppa:{},sliderVal:0,sliderMin:0,sliderMax:0,root:"",alterImgFlag:!0,freshFlag:!1,alterDetail:!0,cursorFlag:!1,centerDialogVisible:!1}},computed:Object(s["a"])({},Object(o["c"])(["verbState","token","self"])),watch:{$route:function(){this.$route.path.endsWith("alterDetail")&&(this.alterDetail=!1)}},created:function(){var t=this;this.width=window.screen.width,this.state=localStorage.getItem("verbState"),this.id=this.$route.params.id;var e={id:this.id};this.$server.getInformation(e).then(function(e){t.user=e,t.detail=e.user_detail,setTimeout(function(){null==t.user.backgroundImg&&t.user.id!=t.self.id||(t.state=!0,t.height=430)},200)}).catch(function(t){console.log(t)})},mounted:function(){this.loading=!1,this.root=this.$URL,this.$route.path.endsWith("alterDetail")&&(this.alterDetail=!1)},methods:Object(s["a"])({},Object(o["d"])({setuser:"SET_USER"}),{onFileTypeMismatch:function(){this.$message({message:"文件格式不对呦 😳",type:"warning"})},onNewImage:function(){this.sliderVal=this.croppa.scaleRatio,this.sliderMin=this.croppa.scaleRatio/2,this.sliderMax=5*this.croppa.scaleRatio},onSliderChange:function(t){var e=t.target.value;this.croppa.scaleRatio=+e},onZoom:function(){this.sliderVal=this.croppa.scaleRatio},upload:function(){var t=this;if(!this.croppa.hasImage())return this.$message({message:"你还没有选择图片 😳",type:"warning"}),!1;this.croppa.generateBlob(function(e){var a=new File([e],"backImg",{type:"image/jpeg"}),i=new FormData;return i.append("image",a),i.append("type","backgroundImg"),t.$server.uploadImg(i).then(function(e){t.detail.backgroundImg=e,t.alterImgFlag=!t.alterImgFlag,t.$message({type:"success",message:"上传成功 😊"})}).catch(function(t){console.log("err",t)}),!1})},alterImg:function(){this.alterImgFlag=!this.alterImgFlag,this.cursorFlag=!this.cursorFlag,this.croppa.refresh()},removeBackgroundImg:function(){var t=this;this.$confirm("移除背景, 是否继续?","提示",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then(function(){var e={type:"backgroundImg"};t.$server.deleteImg(e).then(function(e){if(2==e)return t.$message({type:"warning",message:"还没有背景图 😓"}),!1;t.detail.backgroundImg="",t.croppa.remove(),t.$message({type:"success",message:"移除成功!"}),t.alterImgFlag=!t.alterImgFlag}).catch(function(t){console.log(t)})}).catch(function(){t.$message({type:"info",message:"已取消"})})},alterDetails:function(){this.alterDetail=!this.alterDetail},onInit:function(){this.croppa.addClipPlugin(function(t,e,a,i,n){t.beginPath(),t.arc(e+i/2,a+n/2,i/2,0,2*Math.PI,!0),t.closePath()})},uploadAvatar:function(){var t=this;if(!this.croppa.hasImage())return this.$message({message:"你还没有选择图片 😳",type:"warning"}),!1;this.croppa.generateBlob(function(e){var a=new File([e],"backImg",{type:"image/jpeg"}),i=new FormData;return i.append("image",a),i.append("type","avatar"),t.$server.uploadImg(i).then(function(e){if(2==e)return t.$message({type:"success",message:"上传失败 😓"}),!1;t.$message({type:"success",message:"上传成功 😊"}),t.user.avatar=e,t.setuser(t.user),t.centerDialogVisible=!1}).catch(function(t){console.log("err",t)}),!1})},noEditAvatar:function(){this.croppa.refresh()},removeAvatarImg:function(){var t=this;this.$confirm("移除背景头像, 是否继续?","提示",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then(function(){var e={type:"avatar"};t.$server.deleteImg(e).then(function(e){if(2==e)return t.$message({type:"warning",message:"还没有头像 😓"}),!1;t.user.avatar="",t.croppa.remove(),t.$message({type:"success",message:"移除成功!"}),t.user.avatar="",t.setuser(t.user)}).catch(function(t){console.log(t)})}).catch(function(){t.$message({type:"info",message:"已取消"})})}})},l=r,c=(a("10f1"),a("2877")),d=Object(c["a"])(l,i,n,!1,null,"bd6241b6",null);d.options.__file="index.vue";e["default"]=d.exports},"42d5":function(t,e,a){},aef6:function(t,e,a){"use strict";var i=a("5ca1"),n=a("9def"),s=a("d2c8"),o="endsWith",r=""[o];i(i.P+i.F*a("5147")(o),"String",{endsWith:function(t){var e=s(this,t,o),a=arguments.length>1?arguments[1]:void 0,i=n(e.length),l=void 0===a?i:Math.min(n(a),i),c=String(t);return r?r.call(e,c,l):e.slice(l-c.length,l)===c}})}}]);